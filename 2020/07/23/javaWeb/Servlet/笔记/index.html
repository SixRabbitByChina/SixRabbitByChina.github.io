<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>javaWeb/Servlet/笔记 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1.Servletsjava web第一步 学习Servlet ​    站在巨人的肩膀上看世界，在大牛的路上学IT 1.Servlet API              javax.servlet         其中包含定义Servlet和Servlet容器之间的类和接口                   javax.servlet.http         包含了定义了HTTP Servl">
<meta property="og:type" content="article">
<meta property="og:title" content="javaWeb&#x2F;Servlet&#x2F;笔记">
<meta property="og:url" content="https://sixrabbitbychina.github.io.git/2020/07/23/javaWeb/Servlet/%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="1.Servletsjava web第一步 学习Servlet ​    站在巨人的肩膀上看世界，在大牛的路上学IT 1.Servlet API              javax.servlet         其中包含定义Servlet和Servlet容器之间的类和接口                   javax.servlet.http         包含了定义了HTTP Servl">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-07-23T06:07:08.378Z">
<meta property="article:modified_time" content="2020-07-06T03:02:15.060Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://SixRabbitByChina.github.io.git"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-javaWeb/Servlet/笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/23/javaWeb/Servlet/%E7%AC%94%E8%AE%B0/" class="article-date">
  <time datetime="2020-07-23T06:07:08.378Z" itemprop="datePublished">2020-07-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      javaWeb/Servlet/笔记
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-Servlets"><a href="#1-Servlets" class="headerlink" title="1.Servlets"></a>1.Servlets</h1><p>java web第一步 学习Servlet</p>
<p>​    <u><em>站在巨人的肩膀上看世界，在大牛的路上学IT</em></u></p>
<h2 id="1-Servlet-API"><a href="#1-Servlet-API" class="headerlink" title="1.Servlet API"></a>1.Servlet API</h2><table>
    <tr>
        <td>javax.servlet</td>
        <td>其中包含定义Servlet和Servlet容器之间的类和接口</td>
    </tr>
    <tr>
        <td>javax.servlet.http</td>
        <td>包含了定义了HTTP Servlet和Servlet容器的类和接口</td>
    </tr>
    <tr>
        <td>javax.servlet.annotation</td>
        <td>其中包含了标注Servlet、Filter、Listener的标注，它还为被标注元件定义元数据</td>
    </tr>
    <tr>
        <td>javax.servlet.descriptor</td>
        <td>其中包含提供程序化登录Web应用程序的配置类型</td>
    </tr>
</table>
**Servlet技术的核心是servlet（这句话是废话）**，所有的Servlet类都**必须直接或者间接**的实现一个接口

<blockquote>
<p>载入内存</p>
</blockquote>
<p>Servlet容器将Servlet类载入内存，并在Servlet实例上调用具体方法，<strong>每种Servlet类型只能存在一个实例（这句也是废话）</strong></p>
<blockquote>
<p>细节</p>
</blockquote>
<p>对于每一个应用程序，Servlet容器还会创建一个ServletContext实例，这个对象封装了应用程序的环境配置，每个应用程序只有一个，同时也会生成一个带有Servlet配置的ServletConfig</p>
<h2 id="2-Servlet接口"><a href="#2-Servlet接口" class="headerlink" title="2.Servlet接口"></a>2.Servlet接口</h2><table>
    <tr>
        <td>void init(ServletConfig config) throws ServletException</td>
        <td>当Servlet<strong>第一次被请求时</strong>Servlet容器会调用该方法，后续不在调用。使用时Servlet容器会传入一个ServletConfig。</td>
    </tr>
    <tr>
        <td>void service(ServletRequest request,ServletResponse response) throws ServletException,java.io.IOException</td>
        <td>每次请求时都会调用该方法</td>
    </tr>
    <tr>
        <td>void destroy()</td>
        <td>销毁该Servlet时，容器会调用这个方法，当卸载或者关闭容器时会调用这个方法</td>
    </tr>
    <tr>
        <td>java.lang.String getServletInfo()</td>
        <td>返回这个servlet的描述</td>
    </tr>
    <tr>
        <td>ServletConfig getServletConfig()</td>
        <td>返回容器传入的init()的ServletConfig。必须将init方法的ServletConfig付给一个类级变量</td>
    </tr>
</table>

<blockquote>
<p>注意</p>
</blockquote>
<p>Servlet实例会被一个应用程序所有的用户共享，不建议使用类级变量，除非是只读或者是java.util.concurrent.atomic包成员。</p>
<h2 id="3-解剖Servlet应用程序"><a href="#3-解剖Servlet应用程序" class="headerlink" title="3.解剖Servlet应用程序"></a>3.解剖Servlet应用程序</h2><p>按照惯例，Servlet类的名称应该由Servlet作为后缀。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.EOFException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"MyServlet"</span>,urlPatterns = &#123;<span class="string">"/my"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span>  ServletConfig servletConfig;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.servletConfig=servletConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> servletConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"MyServlet"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        String servletName = servletConfig.getServletName();</span><br><span class="line">        servletResponse.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = servletResponse.getWriter();</span><br><span class="line">        writer.print(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;Hello from"</span> + servletName + <span class="string">"&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Web Servlet标注</p>
</blockquote>
<p>name属性可选，urlPatterns也是可选，但是十分重要，一般都是有的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:8080&#x2F;Demo04_war&#x2F;my</span><br></pre></td></tr></table></figure>

<p>IDEA这是访问该servlet的URL</p>
<h2 id="4-ServletRequest"><a href="#4-ServletRequest" class="headerlink" title="4.ServletRequest"></a>4.ServletRequest</h2><p>对于每一个HTTP请求，Servlet容器都会创建一个ServletRequest实例，封装了请求的信息并传给Service方法</p>
<table>
    <tr>
        <td>public int getContentlength()</td>
        <td>返回请求主体字数，否则返回-1</td>
    </tr>
    <tr>
        <td>public java.lang.String getContentType()</td>
        <td>返回请求主体的MIME类型，否则返回null</td>
    </tr>
    <tr>
        <td>public java.lang.String getParameter(java.lang.String name)</td>
        <td>返回指定参数的值</td>
    </tr>
    <tr>
        <td>public java.lang.String getProtocol()</td>
        <td>返回这个HTTP请求的协议名称和版本</td>
    </tr>
</table>

<blockquote>
<p>方法使用</p>
</blockquote>
<p>getParameter通常用于返回HTML表单域的值</p>
<p>getParameter也可用于获取查询字符串的值，例如一下的URL调用的Servlet:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;domain&#x2F;context&#x2F;servletName?id&#x3D;123</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String id = request.getParameter(<span class="string">"id"</span>);</span><br></pre></td></tr></table></figure>

<p>回去id的值，如果无法获取，返回null</p>
<h2 id="5-ServletResponse"><a href="#5-ServletResponse" class="headerlink" title="5.ServletResponse"></a>5.ServletResponse</h2><p>javax.servlet.ServletResponse接口表示一个Servlet响应，调用Servlet的service方法时，容器会先创建一个ServletResponse传给service。</p>
<p>ServletResponse中的getWriter方法，他返回了一个可以向客户端发送文本的java.io.PrintWriter。PrintWriter默认使用ISO-8895-1编码</p>
<p><strong>注意：getOutStream也可以用来浏览器发送传输。这个方法是用来发送二进制数据的</strong></p>
<blockquote>
<p>注意事项</p>
</blockquote>
<p>发送HTML标签时，都应该先调用setContentType方法，设置响应的内容类型，”text/html”告诉浏览器传入的是HTML类型。如果没有则会被渲染成浏览器默认类型。</p>
<h2 id="6-ServletConfig"><a href="#6-ServletConfig" class="headerlink" title="6.ServletConfig"></a>6.ServletConfig</h2><p>当容器初始化Servlet时，容器会给Servlet的init方法传入一个ServletConfig。封装可以通过@WebServlet或者部署描述符传给Servlet的配置信息，这样传入的每一条信息就叫一个初始参数，每个初始参数有key和value两个元件</p>
<blockquote>
<p>方法</p>
</blockquote>
<p>获取初始参数的值，要在init方法的ServletConfig中调用getInitParameter方法，方法签名如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.<span class="function">String <span class="title">getInitParameter</span><span class="params">(java.lang.String name)</span></span></span><br></pre></td></tr></table></figure>

<p>getInitParameterNames方法则是返回所有参数名称的一个Enumeration：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.util.Enumeration&lt;java.lang.String&gt; getInitParameterNames()</span><br></pre></td></tr></table></figure>

<p>eg：获取contactName的参数值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String contactName = servletConfig.getInitParameter(<span class="string">"contactName"</span>)</span><br></pre></td></tr></table></figure>

<p>Demo:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebInitParam;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"ServletConfigDemoServlet"</span>,</span><br><span class="line">        urlPatterns = &#123;<span class="string">"/servletConfigDemo"</span>&#125;,</span><br><span class="line">        initParams = &#123;</span><br><span class="line">            <span class="meta">@WebInitParam</span>(name = <span class="string">"admin"</span>,value = <span class="string">"Harry Taciak"</span>), <span class="meta">@WebInitParam</span>(name = <span class="string">"email"</span>,value = <span class="string">"admin@example.com"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServletConfigDemoServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> ServletConfig servletConfig;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.servletConfig=servletConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> servletConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ServletConfig demo"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ServletConfig servletConfig = getServletConfig();</span><br><span class="line">        String admin = servletConfig.getInitParameter(<span class="string">"admin"</span>);</span><br><span class="line">        String email = servletConfig.getInitParameter(<span class="string">"email"</span>);</span><br><span class="line">        servletResponse.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = servletResponse.getWriter();</span><br><span class="line">        writer.print(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;"</span> + <span class="string">"Admin:"</span> + admin + <span class="string">"&lt;br/&gt;Email:"</span> + email + <span class="string">"&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在@WebServlet的initParams属性中，给Servlet传入了两个初始参数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"ServletConfigDemoServlet"</span>,</span><br><span class="line">        urlPatterns = &#123;<span class="string">"/servletConfigDemo"</span>&#125;,</span><br><span class="line">        initParams = &#123;</span><br><span class="line">            <span class="meta">@WebInitParam</span>(name = <span class="string">"admin"</span>,value = <span class="string">"Harry Taciak"</span>), <span class="meta">@WebInitParam</span>(name = <span class="string">"email"</span>,value = <span class="string">"admin@example.com"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>利用一下URL访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:8080&#x2F;Demo04_war&#x2F;servletConfigDemo</span><br></pre></td></tr></table></figure>

<p>除以上方法外，还可以使用部署描述符，因为部署描述符是一个文本文件，所以不需要重新编译Servlet类。</p>
<h2 id="7-ServletContext"><a href="#7-ServletContext" class="headerlink" title="7.ServletContext"></a>7.ServletContext</h2><p>ServletContext表示Servlet应用程序，每个web应用程序只有一个上下文。将一个应用程序同时部署到多个容器的分布式环境中，每台JVM上的web应用都会有一个ServletContext对象。</p>
<p>通过在ServletConfig中调用getServletContext方法，可以获取ServletContext。</p>
<p>ServletContext可以共享从应用程序中所有资料处访问到的信息，并且可以动态注册web对象。前者将对象保存在ServletContext中的一个内部Map中。保存在ServletContext中的对象称作属性</p>
<blockquote>
<p>负责处理属性的方法</p>
</blockquote>
<table>
    <tr>
        <td>java.lang.Object getAttribute(java.lang.String name)</td>
    </tr>
    <tr>
        <td>java.util.Enumeration<java.lang.String> getAttributeNames()</td>
    </tr>
    <tr>
        <td>void setAttribute(java.lang.String name,java.lang.Object object)</td>
    </tr>
    <tr>
        <td>void removeAttribute(java.lang.String name)</td>
    </tr>
</table>

<h2 id="8-GenericServlet抽象类"><a href="#8-GenericServlet抽象类" class="headerlink" title="8.GenericServlet抽象类"></a>8.GenericServlet抽象类</h2><p>相比Servlet接口，GenericServlet抽象类实现了Servlet和ServletConfig接口，并且减少了许多不必要的代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebInitParam;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"GenericServletDemoServlet"</span>,</span><br><span class="line">        urlPatterns = &#123;<span class="string">"/generic"</span>&#125;,</span><br><span class="line">        initParams = &#123;</span><br><span class="line">                <span class="meta">@WebInitParam</span>(name = <span class="string">"admin"</span>,value = <span class="string">"Harry Taciak"</span>), <span class="meta">@WebInitParam</span>(name = <span class="string">"email"</span>,value = <span class="string">"admin@example.com"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericServletDemoServlet</span> <span class="keyword">extends</span>  <span class="title">GenericServlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">62500890L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ServletConfig servletConfig = getServletConfig();</span><br><span class="line">        String admin = servletConfig.getInitParameter(<span class="string">"admin"</span>);</span><br><span class="line">        String email = servletConfig.getInitParameter(<span class="string">"email"</span>);</span><br><span class="line">        servletResponse.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = servletResponse.getWriter();</span><br><span class="line">        writer.print(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;"</span> + <span class="string">"Admin:"</span> + admin + <span class="string">"&lt;br/&gt;Email:"</span> + email + <span class="string">"&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-HttpServlet抽象类"><a href="#9-HttpServlet抽象类" class="headerlink" title="9.HttpServlet抽象类"></a>9.HttpServlet抽象类</h2><p>相比之前的Servlet和GenericService抽象类显得过于繁琐，所以就有了HttpServlet。</p>
<blockquote>
<p>详解</p>
</blockquote>
<p>它继承了javax.servlet.GenericServlet类，使用它需要用到HttpServletRequest和HttpServletResponse对象。</p>
<p>它覆盖掉了GenericServlet的service()，并且通过以下签名在添加一个service方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request,HttpServletResponse respone)</span> <span class="keyword">throws</span> ServletException,java.io.IOException</span></span><br></pre></td></tr></table></figure>

<p>Servlet容器调用javax.servlet.Servlet中的原始的Service方法，HttpServlet编写如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req,ServletResponse res)</span><span class="keyword">throws</span> ServletException,IOException</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HttpServletRequest request;</span><br><span class="line">    HttpServletResponse response;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        request = (HttpServletRequest)req;</span><br><span class="line">        response = (HttpServletResponse)res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(ClassCastException e)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ServletException(<span class="string">"non-HTTP request to response"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    service(request,response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>原始的service方法将Servlet容器传入的两个对象分别转换成HttpServletRequest和HttpServletResponse，并且调用新的service方法。</p>
<p>然后HttpServlet中的service()会校验用来发送请求的HTTP方法，并且调用一下方法之一：doGet、doPost、doHead、doPut、doTrace、doOptions和doDelete。因此不需要去覆盖service()发明合法，只需要覆盖doGet和doPost即可。</p>
<blockquote>
<p>总结</p>
</blockquote>
<ul>
<li>不需要覆盖service()方法，只需要覆盖doGet和doPost方法等。</li>
<li>使用的是HttpServletRequest和HttpServletResponse。</li>
</ul>
<blockquote>
<h3 id="HttpServletRequest新增方法"><a href="#HttpServletRequest新增方法" class="headerlink" title="HttpServletRequest新增方法"></a>HttpServletRequest新增方法</h3></blockquote>
<table>
    <tr>
        <td>java.lang.String getContextPath()</td>
        <td>返回表示请求上下文的请求URL部分</td>
    </tr>
    <tr>
        <td>Cookie[] getCookies()</td>
        <td>返回一个Cookie对象数组</td>
    </tr>
    <tr>
        <td>java.lang.String getHeader(java.lang.String name)</td>
        <td>返回指定的HTTP标题值</td>
    </tr>
    <tr>
        <td>java.lang.String getMethod()</td>
        <td>返回生成这个请求的HTTP方法名称</td>
    </tr>
    <tr>
        <td>java.lang.String getQueryString()</td>
        <td>返回URL中的查询字符串</td>
    </tr>
    <tr>
        <td>HttpSession getSession()</td>
        <td>返回与这个请求相关的会话，如果没有就创建一个</td>
    </tr>
    <tr>
        <td>HttpSession getSession(boolean create)</td>
        <td>返回与这个请求相关的会话，如果没有就根据create参数判断，是否创建一个</td>
    </tr>
</table>



<blockquote>
<h3 id="HttpServletResponse新增方法"><a href="#HttpServletResponse新增方法" class="headerlink" title="HttpServletResponse新增方法"></a>HttpServletResponse新增方法</h3></blockquote>
<table>
    <tr>
        <td>void addCookie(Cookie cookie)</td>
        <td>给这个响应对象添加一个cookie</td>
    </tr>
    <tr>
        <td>void addHeader(java.lang.String name,java.lang.String value)</td>
        <td>给响应对象添加一个header</td>
    </tr>
    <tr>
        <td>void sendRedirect(java.lang.String location)</td>
        <td>返送一条响应码，跳转到指定位置</td>
    </tr>
</table>

<h2 id="10-处理HTML表单"><a href="#10-处理HTML表单" class="headerlink" title="10.处理HTML表单"></a>10.处理HTML表单</h2><p>相对与画窗体，画网页也同样简单，但是如何获取到不同控件的值。</p>
<blockquote>
<p>思绪</p>
</blockquote>
<p>HTML的select元素也向header返送了一个字符串。如果select元素中没有任何选项被选中，那么就会发出所显示的这个选项值。</p>
<p>包含多个值的select元素发出一个字符串数组，必须通过SelectRequest.getParameterValues进行处理。</p>
<p>复选框比较奇特。核查过的复选框会发送字符串”on”到服务器。未经检查的复选框则不会向服务器发送任何信息（废话），ServletRequest.getParameter(fieldName)返回NULL</p>
<p>单选框将选中的值发送到服务器，没选择的同上。</p>
<p>如果一个表单包含多个出入同名的元素，那么所有值都会被提交，并且必须利用ServletRequest.getParameterValue()获取他们。</p>
<blockquote>
<p>Demo</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"FormServlet"</span>,urlPatterns = &#123;<span class="string">"/form"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FormServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">54L</span>;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="keyword">final</span> String TITLE = <span class="string">"Order Form"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        resp.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;head&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;title&gt;"</span> + TITLE + <span class="string">"&lt;/title&gt;&lt;/head&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;body&gt;&lt;h1&gt;"</span> + TITLE + <span class="string">"&lt;/h1&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;form method='post'&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;table&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Name:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;input name='name'/&gt;&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Address&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;textarea name='address' cols='40' rows='5'&gt;&lt;/textarea&gt;&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Country:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;select name='counrey'&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;option&gt;United States&lt;/option&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;option&gt;Canada&lt;/option&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/select&gt;&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Delivery Method:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;input type = 'radio' name = 'deliveryMethod' value='First Class'/&gt;First Class"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;input type = 'radio' name = 'deliveryMethod' value='Second Class'/&gt;Second Class&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Shipping Instructions:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;textarea name='instructions' cols='40' rows='5'&gt;&lt;/textarea&gt;&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&amp;nbsp&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;textarea name='instructions' cols='40' rows='5'&gt;&lt;/textarea&gt;&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Please send me the latest product catalog:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;input type='checkbox' name='catalogRequest'/&gt;&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&amp;nbsp&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;input type='reset'/&gt;&lt;input type='submit'/&gt;&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/table&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/form&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/body&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        resp.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;head&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;title&gt;"</span> + TITLE + <span class="string">"&lt;/title&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/head&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;body&gt;&lt;h1&gt;"</span> + TITLE + <span class="string">"&lt;/h1&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;table&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Name:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;"</span> + req.getParameter(<span class="string">"name"</span>) + <span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Address:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;"</span> + req.getParameter(<span class="string">"address"</span>) + <span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Country&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;"</span> + req.getParameter(<span class="string">"country"</span>) + <span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Shipping Instructions:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;"</span>);</span><br><span class="line">        String[] instructions = req.getParameterValues(<span class="string">"country"</span>);</span><br><span class="line">        <span class="keyword">if</span>(instructions != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (String instruction : instructions)</span><br><span class="line">            &#123;</span><br><span class="line">                writer.println(instruction + <span class="string">"&lt;br&gt;/"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        writer.println(<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Delivery Method:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;"</span> + req.getParameter(<span class="string">"deliveryMethod"</span>) + <span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;Catalog Request:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;"</span>);</span><br><span class="line">        <span class="keyword">if</span>(req.getParameter(<span class="string">"catalogRequest"</span>) == <span class="keyword">null</span>)</span><br><span class="line">            writer.println(<span class="string">"NO"</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            writer.println(<span class="string">"Yes"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/table&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;div style='border:1px solid #ddd;margin-top:40px;font-size:90%'&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"Debug Info&lt;br/&gt;"</span>);</span><br><span class="line">        Enumeration&lt;String&gt; parameterNames = req.getParameterNames();</span><br><span class="line">        <span class="keyword">while</span>(parameterNames.hasMoreElements())</span><br><span class="line">        &#123;</span><br><span class="line">            String paramNames = parameterNames.nextElement();</span><br><span class="line">            writer.println(paramNames + <span class="string">": "</span>);</span><br><span class="line">            String[] paramValues = req.getParameterValues(<span class="string">"paramName"</span>);</span><br><span class="line">            <span class="keyword">for</span>(String paramValue : paramValues)</span><br><span class="line">            &#123;</span><br><span class="line">                writer.println(paramValue + <span class="string">"&lt;/br&gt;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        writer.println(<span class="string">"&lt;/div&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/body&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="11-部署描述符"><a href="#11-部署描述符" class="headerlink" title="11.部署描述符"></a>11.部署描述符</h2><p>Servlet有两种部署方式，一种是WebServlet标记部署，还有一种，就是web.xml部署。</p>
<p>web.xml一般位于WEB-INF目录下</p>
<blockquote>
<p>Demo</p>
</blockquote>
<p>两个没有标记的Servlet项目。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">8946L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        resp.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;Simple Servlet&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WelcomeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">27126L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        resp.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;Welcome&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>web.xml文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">web-app</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta"> <span class="meta-string">"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"</span></span></span><br><span class="line"><span class="meta"> <span class="meta-string">"http://java.sun.com/dtd/web-app_2_3.dtd"</span> &gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Archetype Created Web Application<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--SimpleServlet部署--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SimpleServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.bdqn.servlet.SimpleServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>10<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SimpleServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/simple<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--Welcome部署--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>WelcomeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.bdqn.servlet.WelcomeServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>10<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>WelcomeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/welcome<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>以后详解</strong></p>
<h1 id="2-会话管理"><a href="#2-会话管理" class="headerlink" title="2.会话管理"></a>2.会话管理</h1><p>HTTP协议的无状态性，导致一些web服务器无法确认HTTP请求是否为第一次访问，所以他们创造（create）了一个叫做会话的东西。</p>
<blockquote>
<p>摘自JSP笔记</p>
</blockquote>
<h3 id="什么是会话"><a href="#什么是会话" class="headerlink" title="什么是会话?"></a>什么是会话?</h3><p>一个会话就是指在一段时间中，一个用户与web服务器的一连串相关的交互过程（其中包含请&amp;响应过程）。</p>
<p>当用户向服务器发起一次请求时，服务器就会为该用户创建<strong>一个唯一会话</strong>，直到用户访问结束，如果一个用户发起请求，服务器就会判断是否已经创建与该用户的为已请求</p>
<p>​        服务器会根据sessionid这个唯一标识来判断是否和该用户创建会话，如果请求中包含一个sessionid，说明已经建立了一个会话，服务器会根据这个sessionid将相应的会话对象读取出来</p>
<p>如果没有，就创建一个新的会话。</p>
<p>sessionid是采用cookie来实现的</p>
<h2 id="1-URL重写"><a href="#1-URL重写" class="headerlink" title="1.URL重写"></a>1.URL重写</h2><p>URL重写是一种会话跟踪技术，他将一个或多个token添加到URL的查询字符串中，每个token通常以key/value(键值对)的形式存在。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://…………?key-1=value-1&amp;key-2=value-2...key-n=value-n</span><br></pre></td></tr></table></figure>

<p><em>注意：*</em>url和token用？分割，token用&amp;分开***</p>
<blockquote>
<p>规范</p>
<p>注意：括号中的都是原书屁话</p>
</blockquote>
<ul>
<li>URL在某些网站上最大长度为2000字符串</li>
<li>诺需要将值传递下一个资源中，需要将值插入到链接中。（<strong>换句话说：静态页面很难传值</strong>）</li>
<li>URL重写需要在服务端上完成，所有链接都必须带值。（当一个页面存在多条链接时，处理过程是个不小的困难）</li>
<li>某些字符，例如空格、与(&amp;)和问好等都必须使用base64编码（这句话都是屁话）</li>
<li>所有信息都可见，某些情况中不合适。</li>
</ul>
<p>因为存在以上信息限制，所以URL重写仅在轻量级数据传递，且对信息本身不敏感。</p>
<blockquote>
<p>Demo解析</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"Top10Servlet"</span>,urlPatterns = &#123;<span class="string">"/top10"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Top10Servlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">987654321L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; londonAttractions;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; parisAttractions;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        londonAttractions = <span class="keyword">new</span> ArrayList&lt;String&gt;(<span class="number">10</span>);</span><br><span class="line">        londonAttractions.add(<span class="string">"Tian Jin"</span>);</span><br><span class="line">        londonAttractions.add(<span class="string">"Bei Jin"</span>);</span><br><span class="line">        londonAttractions.add(<span class="string">"Shang Hai"</span>);</span><br><span class="line">        londonAttractions.add(<span class="string">"Wu Han"</span>);</span><br><span class="line">        londonAttractions.add(<span class="string">"Chang Sha"</span>);</span><br><span class="line">        londonAttractions.add(<span class="string">"Chong Qing"</span>);</span><br><span class="line">        londonAttractions.add(<span class="string">"Hong Kong"</span>);</span><br><span class="line">        londonAttractions.add(<span class="string">"Shan Xi"</span>);</span><br><span class="line">        londonAttractions.add(<span class="string">"Cheng Du"</span>);</span><br><span class="line">        londonAttractions.add(<span class="string">"Nan Jing"</span>);</span><br><span class="line"></span><br><span class="line">        parisAttractions = <span class="keyword">new</span> ArrayList&lt;String&gt;(<span class="number">10</span>);</span><br><span class="line">        parisAttractions.add(<span class="string">"天津"</span>);</span><br><span class="line">        parisAttractions.add(<span class="string">"北京"</span>);</span><br><span class="line">        parisAttractions.add(<span class="string">"上海"</span>);</span><br><span class="line">        parisAttractions.add(<span class="string">"武汉"</span>);</span><br><span class="line">        parisAttractions.add(<span class="string">"长沙"</span>);</span><br><span class="line">        parisAttractions.add(<span class="string">"重庆"</span>);</span><br><span class="line">        parisAttractions.add(<span class="string">"香港"</span>);</span><br><span class="line">        parisAttractions.add(<span class="string">"陕西"</span>);</span><br><span class="line">        parisAttractions.add(<span class="string">"成都"</span>);</span><br><span class="line">        parisAttractions.add(<span class="string">"南京"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        String city = req.getParameter(<span class="string">"city"</span>);</span><br><span class="line">        <span class="keyword">if</span>(city != <span class="keyword">null</span> &amp;&amp; (city.equals(<span class="string">"london"</span>)|| city.equals(<span class="string">"paris"</span>)))</span><br><span class="line">        &#123;</span><br><span class="line">            showAttractions(req,resp,city);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            showMainPage(req,resp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">showMainPage</span><span class="params">(HttpServletRequest request,HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException,IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = response.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Top 10 Tourist Attractions&lt;/title&gt;&lt;/head&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;body&gt;Please select a city:&lt;br/&gt;&lt;a href='?city=london'&gt;London&lt;/a&gt;&lt;/br&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;a href='?city=paris'&gt;Paris&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">showAttractions</span><span class="params">(HttpServletRequest request,HttpServletResponse response,String city)</span> <span class="keyword">throws</span> ServletException,IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> page= <span class="number">1</span>;</span><br><span class="line">        String pageParameter = request.getParameter(<span class="string">"page"</span>);</span><br><span class="line">        <span class="keyword">if</span>(pageParameter != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                page = Integer.parseInt(pageParameter);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (NumberFormatException e)</span><br><span class="line">            &#123;</span><br><span class="line">                 e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(page &gt; <span class="number">2</span>)</span><br><span class="line">                page = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;String&gt; attractions = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(city.equals(<span class="string">"london"</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            attractions = londonAttractions;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(city.equals(<span class="string">"paris"</span>));</span><br><span class="line">        &#123;</span><br><span class="line">            attractions = parisAttractions;</span><br><span class="line">        &#125;</span><br><span class="line">        response.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = response.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Top 10 Tourist Attractions&lt;/title&gt;&lt;/head&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;body&gt;&lt;a href='top10'&gt;Select City&lt;/a&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;hr/&gt;Page "</span> + page + <span class="string">" &lt;hr/&gt;"</span>);</span><br><span class="line">        <span class="keyword">int</span> start = page * <span class="number">5</span> - <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = start; i &lt; start + <span class="number">5</span> ; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            writer.println(attractions.get(i) + <span class="string">"&lt;br/&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        writer.println(<span class="string">"&lt;hr style='color:blue'/&gt;&lt;a href='?city="</span> + city + <span class="string">"&amp;page=1'&gt;Page 1"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;hr style='color:blue'/&gt;&lt;a href='?city="</span> + city + <span class="string">"&amp;page=2'&gt;Page 2"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>init()剖析</p>
</blockquote>
<p>init由于时servlet创建时第一个调用，初始化了两个景点列表</p>
<blockquote>
<p>doGet()剖析</p>
</blockquote>
<p>每次请求都会调用该方法，所以会检查URL中是否存在参数city,由此决定调用那个方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String city = req.getParameter(<span class="string">"city"</span>);</span><br><span class="line"><span class="keyword">if</span>(city != <span class="keyword">null</span> &amp;&amp; (city.equals(<span class="string">"london"</span>)|| city.equals(<span class="string">"paris"</span>)))</span><br><span class="line">&#123;</span><br><span class="line">    showAttractions(req,resp,city);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    showMainPage(req,resp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-隐藏域"><a href="#2-隐藏域" class="headerlink" title="2.隐藏域"></a>2.隐藏域</h2><p>类似于URL重写，但是不是将值附加到URL上，而是附加到表单中的隐藏域中，</p>
<blockquote>
<p>Demo</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.bdqn.entity.Customer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"CustomerServlet"</span> ,urlPatterns = &#123;<span class="string">"/customer"</span>,<span class="string">"/editCustomer"</span>,<span class="string">"/updateCustomer"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">20L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Customer&gt; customers = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Customer customer1 = <span class="keyword">new</span> Customer();</span><br><span class="line">        customer1.setId(<span class="number">1</span>);</span><br><span class="line">        customer1.setName(<span class="string">"Donald D."</span>);</span><br><span class="line">        customer1.setCity(<span class="string">"Miami"</span>);</span><br><span class="line"></span><br><span class="line">        customers.add(customer1);</span><br><span class="line"></span><br><span class="line">        Customer customer2 = <span class="keyword">new</span> Customer();</span><br><span class="line">        customer2.setId(<span class="number">2</span>);</span><br><span class="line">        customer2.setName(<span class="string">"Mickey M"</span>);</span><br><span class="line">        customer2.setCity(<span class="string">"Orlando"</span>);</span><br><span class="line">        customers.add(customer2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sendCustomerList</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = response.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Customers&lt;/title&gt;&lt;/head&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;body&gt;&lt;h2&gt;Customers&lt;h2&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;ul&gt;"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Customer customer : customers)</span><br><span class="line">        &#123;</span><br><span class="line">            writer.println(<span class="string">"&lt;li&gt;"</span> + customer.getName() + <span class="string">"("</span> + customer.getCity() + <span class="string">") ("</span> + <span class="string">"&lt;a href='editCustomer?id="</span> + customer.getId() + <span class="string">"'&gt;edit&lt;/a&gt;)"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        writer.println(<span class="string">"&lt;/ul&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Customer <span class="title">getCustomer</span><span class="params">(<span class="keyword">int</span> customerId)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Customer customer : customers)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (customer.getId() == customerId)</span><br><span class="line">                <span class="keyword">return</span> customer;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sendEditCustomerForm</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = response.getWriter();</span><br><span class="line">        <span class="keyword">int</span> customerId = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            customerId = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (NumberFormatException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        Customer customer = getCustomer(customerId);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(customer != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            writer.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Edit Customer&lt;/title&gt;&lt;/head&gt;"</span>);</span><br><span class="line">            writer.println(<span class="string">"&lt;body&gt;&lt;h2&gt;Edit Customer&lt;/h2&gt;"</span>);</span><br><span class="line">            writer.println(<span class="string">"&lt;from method='post' action='updateCustomer'&gt;"</span>);</span><br><span class="line">            writer.println(<span class="string">"&lt;input type='hidden' name='id' value='"</span> + customerId + <span class="string">"'/&gt;"</span>);</span><br><span class="line">            writer.println(<span class="string">"&lt;table&gt;"</span>);</span><br><span class="line">            writer.println(<span class="string">"&lt;tr&gt;&lt;td&gt;Name:&lt;/td&gt;&lt;td&gt;&lt;input name='name' value='"</span> + customer.getName().replaceAll(<span class="string">"'"</span>,<span class="string">"&amp;#39;"</span>) + <span class="string">"'/&gt;&lt;/td&gt;&lt;/tr&gt;"</span>);</span><br><span class="line">            writer.println(<span class="string">"&lt;tr&gt;&lt;td&gt;City:&lt;/td&gt;&lt;td&gt;&lt;input name='City' value='"</span> + customer.getCity().replaceAll(<span class="string">"'"</span>,<span class="string">"&amp;#39;"</span>) + <span class="string">"'/&gt;&lt;/td&gt;&lt;/tr&gt;"</span>);</span><br><span class="line">            writer.println(<span class="string">"&lt;tr&gt;&lt;td colspan='2' style='text-align:right'&gt;&lt;input type='submit' value='Update'/&gt;&lt;/td&gt;&lt;/tr&gt;"</span>);</span><br><span class="line">            writer.println(<span class="string">"&lt;tr&gt;&lt;td&gt;&lt;a href='customer'&gt;Customer List&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;"</span>);</span><br><span class="line">            writer.println(<span class="string">"&lt;/table&gt;"</span>);</span><br><span class="line">            writer.println(<span class="string">"&lt;/form&gt;&lt;/body&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            writer.println(<span class="string">"NO customer found"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> customerId = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            customerId = Integer.parseInt(req.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (NumberFormatException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        Customer customer = getCustomer(customerId);</span><br><span class="line">        <span class="keyword">if</span>(customer != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            customer.setName(req.getParameter(<span class="string">"name"</span>));</span><br><span class="line">            customer.setCity(req.getParameter(<span class="string">"city"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        sendCustomerList(resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        String uri = req.getRequestURI();</span><br><span class="line">        <span class="keyword">if</span>(uri.endsWith(<span class="string">"/customer"</span>))</span><br><span class="line">            sendCustomerList(resp);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            sendEditCustomerForm(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>方法积累</p>
</blockquote>
<table>
    <tr>
        <td>String getRequestURI()</td>
        <td>返回除去host（域名或者ip）部分的路径</td>
    </tr>
    <tr>
        <td>public boolean endsWith(String suffix)</td>
        <td>测试字符串是否以指定的后缀结束</td>
    </tr>
</table>
> Demo剖析
>

<p>Demo一共有三个URL映射，前两个会调用doGet方法，后一个会调用doPost方法，</p>
<p>/customer是该Demo的入口URL，他会列举出在init中初始化的列表customers。</p>
<p>每一个客户后面都会有一个edit链接，其中链接属性是/editCustomer?id=customerId当通过链接访问时会调用doGet方法从而间接的调用sendEditCustomerForm方法而生成一个表单，其中表单中的隐藏域中有客户的ID。</p>
<h2 id="3-Cookies"><a href="#3-Cookies" class="headerlink" title="3.Cookies"></a>3.Cookies</h2><p>URL重写和隐藏域是的传递数据十分方便，但是多页面交互会使得代码过于臃肿于是就有了Cookies</p>
<blockquote>
<p>什么是Cookies?</p>
</blockquote>
<p>cookie是Netscape公司发明，由<strong>服务端</strong>生成并发送给<strong>客户端</strong>，浏览器会保存至目录下的某个文本文件。</p>
<p>当用户在浏览网站时，web服务器会将一些资料存放在客户端，其中包括用户在浏览网站时输入的一些文本和选择记录，当用户<strong>下一次</strong>访问该网站时，服务端会先从客户端查看是否会有保留的cookie信息，然后依据cookie内容呈现特定的内容给客户</p>
<p>cookies是一个很少的信息片段，自动的在浏览器和Web服务器间交互，使得多个页面数据交互变得十分轻松。</p>
<p>用户可以更改浏览器设置来拒绝cookies</p>
<blockquote>
<p>如何正确食用</p>
</blockquote>
<p>使用Cookies需要熟悉javax.servlet.http.Cookie类以及HttpServletRequest和HttpServletResponse两个接口。</p>
<p>下面创建了一个cookie</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(name,value);</span><br></pre></td></tr></table></figure>

<p>创建完成一个cookie对象后可以设置domain、path和maxAge属性，其中maxAge属性决定了cookie的寿命</p>
<p>将cookie发送到浏览器，需要HttpServletResponse的addCookie方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">httpServletResponse.addCookie(cookie);</span><br></pre></td></tr></table></figure>

<p>Cookie也可以通过客户端的js脚本删除和创建（不在此前学习范围内）</p>
<p>读取可以使用HttpServletResponse的getCookies方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询遍历整个cookie</span></span><br><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line">Cookie maxRecordsCookie = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(cookies != <span class="keyword">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span>(Cookie cookie : cookies)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(cookie.getName().equals(<span class="string">"maxRecords"</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			maxRecordsCookie = cookie;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>控制Cookie的方法</p>
</blockquote>
<table>
    <tr>
        <td>方法名称</td>
        <td>说明</td>
    </tr>
    <tr>
        <td>void setMaxAge(int expiry)</td>
        <td>设置cookie的有效期，以秒为单位</td>
    </tr>
    <tr>
        <td>String getName()</td>
        <td>获得cookie的名称</td>
    </tr>
    <tr>
        <td>String getValue()</td>
        <td>获取cookie的值</td>
    </tr>
    <tr>
        <td>int getMaxAge(int expiry)</td>
        <td>获取cookie的有效期，以秒为单位</td>
    </tr>
</table>

<blockquote>
<p>Demo</p>
</blockquote>
<p>PreferenceServlet类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"PreferenceSevlet"</span> ,urlPatterns = &#123;<span class="string">"/preference"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PreferenceSevlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">888L</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String MENU = <span class="string">"&lt;div style='background:#e8e8e8;padding:15px'&gt;"</span></span><br><span class="line">            +<span class="string">"&lt;a href='cookieClass'&gt;Cookie Class&lt;/a&gt;&amp;nbsp;&amp;nbsp;"</span></span><br><span class="line">            +<span class="string">"&lt;a href='cookieInfo'&gt;Cookie Info&lt;/a&gt;&amp;nbsp;&amp;nbsp;"</span></span><br><span class="line">            +<span class="string">"&lt;a href='preference'&gt;Preference&lt;/a&gt;&lt;/div&gt;"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        resp.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Preference&lt;/title&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;style&gt;table&#123;font-size:small;background:NavajoWhite&#125;&lt;/style&gt;&lt;/head&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;body&gt;"</span> + MENU + <span class="string">"Please select the values below:"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;form method='post'&gt;&lt;table&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;&lt;td&gt;Title Font Size:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;select name='titleFontSize'&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;option&gt;large&lt;/option&gt;&lt;option&gt;x-large&lt;/option&gt;&lt;option&gt;xx-large&lt;/option&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/select&gt;&lt;/td&gt;&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;&lt;td&gt;Title Style &amp; Weight:&lt;td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;select name='titleStyleAndWeight' multiple&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;option&gt;italic&lt;/option&gt;&lt;option&gt;bold&lt;/option&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/select&gt;&lt;/td&gt;&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;&lt;td&gt;Max. Records in Table:&lt;/td&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;td&gt;&lt;select name='maxRecords'&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;option&gt;5&lt;/option&gt;&lt;option&gt;10&lt;/option&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/select&gt;&lt;/td&gt;&lt;/tr&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;tr&gt;&lt;td rowspan='2'&gt;&lt;input type='submit' value='Set'/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        String maxRecords = req.getParameter(<span class="string">"maxRecords"</span>);</span><br><span class="line">        String[] titleStyleAndWeight = req.getParameterValues(<span class="string">"titleStyleAndWeight"</span>);</span><br><span class="line">        String titleFontSize = req.getParameter(<span class="string">"titleFontSize"</span>);</span><br><span class="line">        resp.addCookie(<span class="keyword">new</span> Cookie(<span class="string">"maxRecords"</span>,maxRecords));</span><br><span class="line">        resp.addCookie(<span class="keyword">new</span> Cookie(<span class="string">"titleFontSize"</span>,titleFontSize));</span><br><span class="line"></span><br><span class="line">        Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"titleFontWeight"</span>,<span class="string">""</span>);</span><br><span class="line">        cookie.setMaxAge(<span class="number">0</span>);</span><br><span class="line">        resp.addCookie(cookie);</span><br><span class="line"></span><br><span class="line">        cookie = <span class="keyword">new</span> Cookie(<span class="string">"titleFontStyle"</span>,<span class="string">""</span>);</span><br><span class="line">        cookie.setMaxAge(<span class="number">0</span>);</span><br><span class="line">        resp.addCookie(cookie);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(titleStyleAndWeight != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (String style : titleStyleAndWeight)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(style.equals(<span class="string">"bold"</span>))</span><br><span class="line">                    resp.addCookie(<span class="keyword">new</span> Cookie(<span class="string">"titleFontWeight"</span>,<span class="string">"bold"</span>));</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    resp.addCookie(<span class="keyword">new</span> Cookie(<span class="string">"titleFontStyle"</span>,<span class="string">"italic"</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        resp.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Preference&lt;/title&gt;"</span></span><br><span class="line">                + <span class="string">"&lt;/head&gt;&lt;body&gt;"</span> + MENU + <span class="string">"You preference has been set."</span></span><br><span class="line">                + <span class="string">"&lt;br/&gt;&lt;br/&gt;Max.Records in Table:"</span> + maxRecords</span><br><span class="line">                + <span class="string">"&lt;br/&gt;Title Font Size: "</span> + titleFontSize</span><br><span class="line">                + <span class="string">"&lt;br/&gt;Title Font Style &amp; Weight:"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(titleStyleAndWeight != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            writer.println(<span class="string">"&lt;ul&gt;"</span>);</span><br><span class="line">            <span class="keyword">for</span>(String style : titleStyleAndWeight)</span><br><span class="line">            &#123;</span><br><span class="line">                writer.println(<span class="string">"&lt;li&gt;"</span> + style + <span class="string">"&lt;/li&gt;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            writer.println(<span class="string">"&lt;/ul&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        writer.println(<span class="string">"&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CookieClassServlet类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"CookieClassServlet"</span>,urlPatterns = &#123;<span class="string">"/cookieClass"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CookieClassServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">837369L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String[] methods = &#123;<span class="string">"clone"</span>,<span class="string">"getComment"</span>,<span class="string">"getDomain"</span>,<span class="string">"getMaxAge"</span>,<span class="string">"getName"</span>,<span class="string">"getPath"</span>,<span class="string">"getSecure"</span>,<span class="string">"getValue"</span>,<span class="string">"getVersion"</span>,<span class="string">"isHttpOnly"</span>,<span class="string">"setComment"</span>,<span class="string">"setDomain"</span></span><br><span class="line">        ,<span class="string">"setHttpOnly"</span>,<span class="string">"setMaxAge"</span>,<span class="string">"setPath"</span>,<span class="string">"setSecure"</span>,<span class="string">"setValue"</span>,<span class="string">"setVersion"</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Cookie[] cookies= req.getCookies();</span><br><span class="line">        Cookie maxRecordsCookie = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(cookies != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (Cookie cookie : cookies)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(cookie.getName().equals(<span class="string">"maxRecords"</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    maxRecordsCookie = cookie;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//默认为5</span></span><br><span class="line">        <span class="keyword">int</span> maxRecords = <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">if</span>(maxRecordsCookie != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                maxRecords = Integer.parseInt(maxRecordsCookie.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (NumberFormatException e)</span><br><span class="line">            &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        resp.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Cookie Class&lt;/title&gt;&lt;/head&gt;"</span></span><br><span class="line">                    + <span class="string">"&lt;body&gt;"</span></span><br><span class="line">                    + PreferenceSevlet.MENU</span><br><span class="line">                    + <span class="string">"&lt;div&gt;Here are some of the methods in"</span></span><br><span class="line">                    + <span class="string">"javax.servlet.http.Cookie"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;ul&gt;"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; maxRecords;i++)</span><br><span class="line">            writer.println(<span class="string">"&lt;li&gt;"</span> + methods[i] + <span class="string">"&lt;/li&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/ul&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CookieInfoServlet类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bdqn.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"CookieInfoServlet"</span>,urlPatterns = &#123;<span class="string">"/cookieInfo"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CookieInfoServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">3829L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Cookie[] cookies = req.getCookies();</span><br><span class="line">        StringBuilder styles = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        styles.append(<span class="string">".title&#123;"</span>);</span><br><span class="line">        <span class="keyword">if</span>(cookies != <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (Cookie cookie : cookies)</span><br><span class="line">            &#123;</span><br><span class="line">                String name = cookie.getName();</span><br><span class="line">                String value = cookie.getValue();</span><br><span class="line">                <span class="keyword">if</span>(name.equals(<span class="string">"titleFontSize"</span>))</span><br><span class="line">                    styles.append(<span class="string">"font-size:"</span> + value + <span class="string">";"</span>);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(name.equals(<span class="string">"titleFontWeight"</span>))</span><br><span class="line">                    styles.append(<span class="string">"font-weight:"</span> + value + <span class="string">";"</span>);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(name.equals(<span class="string">"titleFontStyle"</span>))</span><br><span class="line">                    styles.append(<span class="string">"font-style:"</span> + value + <span class="string">";"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        styles.append(<span class="string">"&#125;"</span>);</span><br><span class="line">        resp.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line">        writer.println(<span class="string">"&lt;html&gt;&lt;head&gt;&lt;title&gt;Cookie Info&lt;/title&gt;"</span></span><br><span class="line">        + <span class="string">"&lt;style&gt;"</span> + styles.toString() + <span class="string">"&lt;/style&gt;"</span></span><br><span class="line">        + <span class="string">"&lt;/head&gt;&lt;body&gt;"</span> + PreferenceSevlet.MENU</span><br><span class="line">        + <span class="string">"&lt;div class='title'&gt;"</span></span><br><span class="line">        + <span class="string">"Session Management with Cookies:&lt;/div&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;div&gt;"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(cookies == <span class="keyword">null</span>)</span><br><span class="line">            writer.println(<span class="string">"No cookie in this HTTP response"</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            writer.println(<span class="string">"&lt;br/&gt;Cookies in this HTTP response:"</span>);</span><br><span class="line">            <span class="keyword">for</span> (Cookie cookie : cookies)</span><br><span class="line">                writer.println(<span class="string">"&lt;br/&gt;"</span> + cookie.getName() + <span class="string">":"</span> + cookie.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">        writer.println(<span class="string">"&lt;/div&gt;"</span>);</span><br><span class="line">        writer.println(<span class="string">"&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>PreferenceServlet剖析</p>
</blockquote>
<p>当用户提交表单时，web服务器会调用PreferenceServlet的doPost()方法，该方法会创建4个cookies，并且覆盖之前的cookie的值。然后返回给浏览器。</p>
<p><strong>1.doGet方法</strong></p>
<p>由于HttpServlet每次请求都会调用doGet方法，所以使用doGet加载网页。</p>
<p><strong>2.doPost方法</strong></p>
<p>当表单以Post方式提交，会调用doPost方法，同时添加cookie到本地。</p>
<h2 id="4-HttpSession对象"><a href="#4-HttpSession对象" class="headerlink" title="4.HttpSession对象"></a>4.HttpSession对象</h2><p>在会话跟踪技术中，HttpSession对象是最强大最通用的。一个用户最多只有一个HttpSession，并且不会被其他用户访问到。</p>
<blockquote>
<p>怎么创建（获取）Session对象</p>
</blockquote>
<p>HttpSession对象在用户第一次访问网站时就会被创建，可以通过HttpServletRequest的getSession方法获取对象</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sixrabbitbychina.github.io.git/2020/07/23/javaWeb/Servlet/%E7%AC%94%E8%AE%B0/" data-id="ckcyelbo800051sv29wpt30zf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/07/23/javaWeb/Servlet/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E8%A8%80/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          javaWeb/Servlet/表达式语言
        
      </div>
    </a>
  
  
    <a href="/2020/07/23/javaWeb/jsp/3.Cookie/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">javaWeb/jsp/3.Cookie</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/07/23/linux/%E7%AC%94%E8%AE%B0/">linux/笔记</a>
          </li>
        
          <li>
            <a href="/2020/07/23/javaWeb/%E6%B3%A8%E8%A7%A3/@WebServlet/">javaWeb/注解/@WebServlet</a>
          </li>
        
          <li>
            <a href="/2020/07/23/javaWeb/Servlet/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E8%A8%80/">javaWeb/Servlet/表达式语言</a>
          </li>
        
          <li>
            <a href="/2020/07/23/javaWeb/Servlet/%E7%AC%94%E8%AE%B0/">javaWeb/Servlet/笔记</a>
          </li>
        
          <li>
            <a href="/2020/07/23/javaWeb/jsp/3.Cookie/">javaWeb/jsp/3.Cookie</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>